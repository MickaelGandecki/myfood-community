!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).supercluster=t()}}(function(){return function t(n,o,e){function i(s,u){if(!o[s]){if(!n[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var p=o[s]={exports:{}};n[s][0].call(p.exports,function(t){var o=n[s][1][t];return i(o||t)},p,p.exports,t,n,o,e)}return o[s].exports}for(var r="function"==typeof require&&require,s=0;s<e.length;s++)i(e[s]);return i}({1:[function(t,n,o){"use strict";function e(t){return new i(t)}function i(t){this.options=d(Object.create(this.options),t),this.trees=new Array(this.options.maxZoom+1)}function r(t,n,o,e,i){return{x:t,y:n,zoom:1/0,id:o,parentId:-1,numPoints:e,properties:i}}function s(t,n){var o=t.geometry.coordinates;return{x:h(o[0]),y:p(o[1]),zoom:1/0,id:n,parentId:-1}}function u(t){return{type:"Feature",properties:a(t),geometry:{type:"Point",coordinates:[f(t.x),c(t.y)]}}}function a(t){var n=t.numPoints,o=n>=1e4?Math.round(n/1e3)+"k":n>=1e3?Math.round(n/100)/10+"k":n;return d(d({},t.properties),{cluster:!0,cluster_id:t.id,point_count:n,point_count_abbreviated:o})}function h(t){return t/360+.5}function p(t){var n=Math.sin(t*Math.PI/180),o=.5-.25*Math.log((1+n)/(1-n))/Math.PI;return o<0?0:o>1?1:o}function f(t){return 360*(t-.5)}function c(t){var n=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(n))/Math.PI-90}function d(t,n){for(var o in n)t[o]=n[o];return t}function l(t){return t.x}function m(t){return t.y}var v=t("kdbush");n.exports=e,i.prototype={options:{minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,reduce:null,initial:function(){return{}},map:function(t){return t}},load:function(t){var n=this.options.log;n&&console.time("total time");var o="prepare "+t.length+" points";n&&console.time(o),this.points=t;var e=t.map(s);this.trees[this.options.maxZoom+1]=v(e,l,m,this.options.nodeSize,Float32Array),n&&console.timeEnd(o);for(var i=this.options.maxZoom;i>=this.options.minZoom;i--){var r=+Date.now();e=this._cluster(e,i),this.trees[i]=v(e,l,m,this.options.nodeSize,Float32Array),n&&console.log("z%d: %d clusters in %dms",i,e.length,+Date.now()-r)}return n&&console.timeEnd("total time"),this},getClusters:function(t,n){for(var o=this.trees[this._limitZoom(n)],e=o.range(h(t[0]),p(t[3]),h(t[2]),p(t[1])),i=[],r=0;r<e.length;r++){var s=o.points[e[r]];i.push(s.numPoints?u(s):this.points[s.id])}return i},getChildren:function(t,n){for(var o=this.trees[n+1].points[t],e=this.options.radius/(this.options.extent*Math.pow(2,n)),i=this.trees[n+1].within(o.x,o.y,e),r=[],s=0;s<i.length;s++){var a=this.trees[n+1].points[i[s]];a.parentId===t&&r.push(a.numPoints?u(a):this.points[a.id])}return r},getLeaves:function(t,n,o,e){o=o||10,e=e||0;var i=[];return this._appendLeaves(i,t,n,o,e,0),i},getTile:function(t,n,o){var e=this.trees[this._limitZoom(t)],i=Math.pow(2,t),r=this.options.extent,s=this.options.radius/r,u=(o-s)/i,a=(o+1+s)/i,h={features:[]};return this._addTileFeatures(e.range((n-s)/i,u,(n+1+s)/i,a),e.points,n,o,i,h),0===n&&this._addTileFeatures(e.range(1-s/i,u,1,a),e.points,i,o,i,h),n===i-1&&this._addTileFeatures(e.range(0,u,s/i,a),e.points,-1,o,i,h),h.features.length?h:null},getClusterExpansionZoom:function(t,n){for(;n<this.options.maxZoom;){var o=this.getChildren(t,n);if(n++,1!==o.length)break;t=o[0].properties.cluster_id}return n},_appendLeaves:function(t,n,o,e,i,r){for(var s=this.getChildren(n,o),u=0;u<s.length;u++){var a=s[u].properties;if(a.cluster?r+a.point_count<=i?r+=a.point_count:r=this._appendLeaves(t,a.cluster_id,o+1,e,i,r):r<i?r++:t.push(s[u]),t.length===e)break}return r},_addTileFeatures:function(t,n,o,e,i,r){for(var s=0;s<t.length;s++){var u=n[t[s]];r.features.push({type:1,geometry:[[Math.round(this.options.extent*(u.x*i-o)),Math.round(this.options.extent*(u.y*i-e))]],tags:u.numPoints?a(u):this.points[u.id].properties})}},_limitZoom:function(t){return Math.max(this.options.minZoom,Math.min(t,this.options.maxZoom+1))},_cluster:function(t,n){for(var o=[],e=this.options.radius/(this.options.extent*Math.pow(2,n)),i=0;i<t.length;i++){var s=t[i];if(!(s.zoom<=n)){s.zoom=n;var u=this.trees[n+1],a=u.within(s.x,s.y,e),h=s.numPoints||1,p=s.x*h,f=s.y*h,c=null;this.options.reduce&&(c=this.options.initial(),this._accumulate(c,s));for(var d=0;d<a.length;d++){var l=u.points[a[d]];if(!(l.zoom<=n)){l.zoom=n;var m=l.numPoints||1;p+=l.x*m,f+=l.y*m,h+=m,l.parentId=i,this.options.reduce&&this._accumulate(c,l)}}1===h?o.push(s):(s.parentId=i,o.push(r(p/h,f/h,i,h,c)))}}return o},_accumulate:function(t,n){var o=n.numPoints?n.properties:this.options.map(this.points[n.id].properties);this.options.reduce(t,o)}}},{kdbush:2}],2:[function(t,n,o){"use strict";function e(t,n,o,e,r){return new i(t,n,o,e,r)}function i(t,n,o,e,i){n=n||r,o=o||s,i=i||Array,this.nodeSize=e||64,this.points=t,this.ids=new i(t.length),this.coords=new i(2*t.length);for(var a=0;a<t.length;a++)this.ids[a]=a,this.coords[2*a]=n(t[a]),this.coords[2*a+1]=o(t[a]);u(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function r(t){return t[0]}function s(t){return t[1]}var u=t("./sort"),a=t("./range"),h=t("./within");n.exports=e,i.prototype={range:function(t,n,o,e){return a(this.ids,this.coords,t,n,o,e,this.nodeSize)},within:function(t,n,o){return h(this.ids,this.coords,t,n,o,this.nodeSize)}}},{"./range":3,"./sort":4,"./within":5}],3:[function(t,n,o){"use strict";function e(t,n,o,e,i,r,s){for(var u,a,h=[0,t.length-1,0],p=[];h.length;){var f=h.pop(),c=h.pop(),d=h.pop();if(c-d<=s)for(var l=d;l<=c;l++)u=n[2*l],a=n[2*l+1],u>=o&&u<=i&&a>=e&&a<=r&&p.push(t[l]);else{var m=Math.floor((d+c)/2);u=n[2*m],a=n[2*m+1],u>=o&&u<=i&&a>=e&&a<=r&&p.push(t[m]);var v=(f+1)%2;(0===f?o<=u:e<=a)&&(h.push(d),h.push(m-1),h.push(v)),(0===f?i>=u:r>=a)&&(h.push(m+1),h.push(c),h.push(v))}}return p}n.exports=e},{}],4:[function(t,n,o){"use strict";function e(t,n,o,r,s,u){if(!(s-r<=o)){var a=Math.floor((r+s)/2);i(t,n,a,r,s,u%2),e(t,n,o,r,a-1,u+1),e(t,n,o,a+1,s,u+1)}}function i(t,n,o,e,s,u){for(;s>e;){if(s-e>600){var a=s-e+1,h=o-e+1,p=Math.log(a),f=.5*Math.exp(2*p/3),c=.5*Math.sqrt(p*f*(a-f)/a)*(h-a/2<0?-1:1);i(t,n,o,Math.max(e,Math.floor(o-h*f/a+c)),Math.min(s,Math.floor(o+(a-h)*f/a+c)),u)}var d=n[2*o+u],l=e,m=s;for(r(t,n,e,o),n[2*s+u]>d&&r(t,n,e,s);l<m;){for(r(t,n,l,m),l++,m--;n[2*l+u]<d;)l++;for(;n[2*m+u]>d;)m--}n[2*e+u]===d?r(t,n,e,m):r(t,n,++m,s),m<=o&&(e=m+1),o<=m&&(s=m-1)}}function r(t,n,o,e){s(t,o,e),s(n,2*o,2*e),s(n,2*o+1,2*e+1)}function s(t,n,o){var e=t[n];t[n]=t[o],t[o]=e}n.exports=e},{}],5:[function(t,n,o){"use strict";function e(t,n,o,e,r,s){for(var u=[0,t.length-1,0],a=[],h=r*r;u.length;){var p=u.pop(),f=u.pop(),c=u.pop();if(f-c<=s)for(var d=c;d<=f;d++)i(n[2*d],n[2*d+1],o,e)<=h&&a.push(t[d]);else{var l=Math.floor((c+f)/2),m=n[2*l],v=n[2*l+1];i(m,v,o,e)<=h&&a.push(t[l]);var g=(p+1)%2;(0===p?o-r<=m:e-r<=v)&&(u.push(c),u.push(l-1),u.push(g)),(0===p?o+r>=m:e+r>=v)&&(u.push(l+1),u.push(f),u.push(g))}}return a}function i(t,n,o,e){var i=t-o,r=n-e;return i*i+r*r}n.exports=e},{}]},{},[1])(1)});
